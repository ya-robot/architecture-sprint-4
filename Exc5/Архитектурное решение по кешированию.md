## Мотивация

Кэширование — это важная техника, которая улучшает производительность и эффективность веб-приложений. 
Причины, почему необходимо кэширование:

1. Улучшение времени загрузки
Кэширование хранит копии часто запрашиваемых данных, что позволяет приложениям быстро извлекать эти данные 
без необходимости каждый раз запрашивать их с сервера. Это значительно сокращает время загрузки страниц и 
обеспечивает более плавный пользовательский опыт.

2. Снижение нагрузки на сервер
Путем предоставления кэшированного контента минимизируется количество запросов, поступающих на основной сервер.
Это снижает нагрузку на ресурсы сервера, позволяя ему обрабатывать больше пользователей одновременно без ухудшения производительности.

3. Улучшение пользовательского опыта
Кэширование позволяет ускорить время отклика и может обеспечить оффлайн-функциональность, 
когда пользователи могут по-прежнему получать доступ к определенным функциям приложения без подключения к интернету. 
Это особенно полезно для прогрессивных веб-приложений (PWA), которые стремятся предоставить опыт, схожий с нативным приложением.

4. Экономия затрат
Снижение количества запросов к серверу не только улучшает производительность, но и может снизить операционные расходы, 
связанные с пропускной способностью и мощностью сервера. Это особенно актуально для приложений с высоким объемом трафика.

5. Сети доставки контента (CDN)
Использование CDN для кэширования может дополнительно улучшить производительность, храня контент ближе к пользователям географически. 
Это снижает задержки и обеспечивает более быструю доставку ресурсов, улучшая общую отзывчивость приложения.

## Предлагаемое решение

1. Client side
Предлагается наладить кеширование бандлов и статики, которые клиенты и сотрудники получают для отрисовки UI и поторяющихся элементов в
SPA прилржениях. Это возможно реализовать на уровне API Gateway, где для раутов, отвечающих за выдачу статического контента можно определить
правила кеширования.

Кеш пометить как `public, max-age=xxx`.

2. Server side

Предлагается кэшировать ресурсозатратные (query intensive) и часто запрашиваемые элементы:

- Cache aside (часто используемые результаты операции чтения)
    - Заказы пользователя
    - Список товаров
    - Заказы назначенные операторам
    - Статусы заказов
    - Компоненты для создания 3D модели
- Write Through (нужна консистентность данных)
    - Заказ
    - Вычисление стоимости заказа

[Диаграмма кеширования списка заказов и записи статуса](https://drive.google.com/file/d/1v9BxZmAlhJRamIQon6S-qbTcLSaqILk3/view?usp=sharing)


### Инвалидация кеша

Для клиенского кеша подходит ивалидация на уровне `max-age` и `TTL`, так как для отрисовки обновленного UI, который обновляется не так часто,
что позволяет найти золотую серидину, если поиграться протуханием кеша в браузере.

Что касается серверной части, то тут наиболее комплексная задача. Однако можно определить общий петтерн операций,
к которым подойдет тот или иной вид инвалидации.

Вот некоторые примеры:
- Список товаров - инвалидация на основе изменений, так как мы можем обновлять общий кеш листинга при добавление нового товара через CRM.
- Список заказов пользователя - инвалидация, основанная на запросах, так как мы можем сбрасывать кеш пользователя по его заказам при добавлении нового.
- Стоимость заказа - инвалидация на основе изменений, так как мы можем обновить кеш для пользователя на основе решений в CRM.
- Статус заказа - инвалидация на основе изменений, так как мы можем обновить кеш для пользователя на основе изменений в жизненном цикле заказа.